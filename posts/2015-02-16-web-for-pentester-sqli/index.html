<!DOCTYPE html>
<html>
<head>
    <title>Web for Pentester SQLi // multiplex3r.github.io</title>

    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    
    

        <meta property="og:title" content="Web for Pentester SQLi" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="en" />
    <meta property="og:url" content="https://multiplex3r.github.io/posts/2015-02-16-web-for-pentester-sqli/" />
    

    <link rel="shortcut icon" href="/favicon.ico">

    <link href="https://multiplex3r.github.io/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://multiplex3r.github.io/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://multiplex3r.github.io/css/style.css">
    

    <meta name="generator" content="Hugo 0.74.3" />
</head>


<body>
<div id="container">
    <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://multiplex3r.github.io/">multiplex3r.github.io</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/about/">About me</a>
                
                <a class="main-nav-link" href="/tags/">Tags</a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

    <section id="main" class="outer">
        <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">Web for Pentester SQLi</h1>
        </header>
        
        <div class="article-meta">
            <a href="/posts/2015-02-16-web-for-pentester-sqli/" class="article-date">
                <time datetime='2015-02-16T10:14:43.000&#43;11:00' itemprop="datePublished">2015-02-16</time>
            </a>
            
            
            
        </div>
        <div class="article-entry" itemprop="articleBody">
            <p>Welcome back to another installment of Web for Pentester I. This post is going to go over the SQL Injection examples. Manually iterating over SQLi can be quite a complex subject, however, thankfully there are many tools availble to help us in this endeavour. Personally, I use SQLMap and Burp Suite pro.</p>
<p>Warning! Spoilers ahead!</p>
<h3 id="sql-injection">SQL Injection</h3>
<p>SQL Injections are one of the most common (web) vulnerabilities. SQL injectinos come from a lack of encoding/escaping user-controlled input when included in SQL queries.</p>
<h4 id="example-1">Example 1</h4>
<p>This example only offers us a way to understand if we are in fact testing a parameter which is susceptable to SQLi.</p>
<p>To test this if we change the parameter does it change the output? What if we use a single or double quote?</p>
<p>If we use the below string we can see that we have a point of injection.</p>
<p><code>http://pentesterlab/sqli/example1.php?name=root' or '1'='1</code></p>
<h4 id="example-2">Example 2</h4>
<p>In this example the use of spaces is blocked by the developer.</p>
<p><code>ERROR NO SPACE</code></p>
<p>There are many ways to bypass this control however the easiest would be to use a <code>\t</code> tab character. We have to URL encode this though <code>%09</code>.</p>
<p>From here we can modify our payload so that it works.</p>
<p><code>http://pentesterlab/sqli/example2.php?name=root'%09or%09'1'='1</code></p>
<h4 id="example-3">Example 3</h4>
<p>Using the payload from the previous example we can see that the developer is onto our sneaky tricks and has added a control for tabs in our payload. What&rsquo;s another way we can still get injection?</p>
<p>Comments!</p>
<p><code>http://pentesterlab/sqli/example3.php?name=root'/**/or/**/'1'='1</code></p>
<h4 id="example-4">Example 4</h4>
<p>Here we start seeing some mitigations. However in this example it is poorly implemented.</p>
<p><code>mysql_real_escape_string</code> - Escapes special characters in a string for use in an SQL statement. This is actually deprecated after PHP 5.5.0.</p>
<p><code>mysqli_real_escape_string</code> - Escapes special characters in a string for use in an SQL statement, taking into account the current charset of the connection.</p>
<p>The following payload succesfully injects this example.
<code>http://pentesterlab/sqli/example4.php?id=2 or 1=1</code></p>
<h4 id="example-5">Example 5</h4>
<p>For this example, we also have to deal with a regex which is looking to ensure that the ID parameter is an integer. However this is poorly implemented as the regex only checks to ensure that ID <em>STARTS</em> with an integer.</p>
<p><code>http://pentesterlab/sqli/example5.php?ID=2 or 1=1</code></p>
<p>The above payload still works in this instance as the regex requirements are met. ID starts with an integer.</p>
<h4 id="example-6">Example 6</h4>
<p>This example is the other way around. The developer made a mistake in the regular expression again. This regular expression only ensures that the parameter <code>ID</code> <em>ends</em> with a digit (thanks to the <code>$</code> sign). It does not ensure that the beginning of the parameter is valid (missing <code>^</code>). You can use the methods learnt previously. You just need to add an integer at the end of your payload. This digit can be part of the payload or placed after a SQL comment: <code>1 or 1=1 # 123</code></p>
<p><code>http://pentesterlab/sqli/example6.php?id=2 or 1=1</code></p>
<h4 id="example-7">Example 7</h4>
<p>This is another example of bad regex. Here we can see that the beginning (<code>^</code>) and end (<code>$</code>) of the string are correctly checked. However, the regular expression contains the modifier PCRE_MULTILINE (<code>/m</code>). The multiline modifier will only validate that one of the lines is only containing an integer, and the following values will therefore be valid (thanks to the new line in them):</p>
<ul>
<li>123\nPAYLOAD;</li>
<li>PAYLOAD\n123;</li>
<li>PAYLOAD\n123\nPAYLOAD;</li>
</ul>
<p><code>http://pentesterlab/sqli/example7.php?id=2%0A or 1=1</code></p>
<h4 id="example-8">Example 8</h4>
<p>In this example we are adjusting the way we view the table with the ORDER BY MySQL statement. The ORDER BY statement cannot be used with values inside single quotes <code>'</code> or double quotes <code>&quot;</code>. If this is used, nothing will get sorted, since MySQL considers these as constants.</p>
<p>To detect this type of vulnerability we can try to get the same result using different payloads:</p>
<ul>
<li><code>name\</code> # `</li>
<li><code>name\</code> ASC #`</li>
<li><code>name\</code>, `name`</li>
</ul>
<p>And the following payloads should give different results:</p>
<ul>
<li><code>name\</code> DESC #`</li>
<li>`name``</li>
</ul>
<p>The payload used in this case was:</p>
<p><code>http://pentesterlab/sqli/example8.php?order=name\</code> # or order=name`,`name`</p>
<h4 id="example-9">Example 9</h4>
<p>This is the final SQLi example, which is geared more around detection of there being an SQLi vulnerability. Here we can try using the <code>IF</code> statement to ascertain whether there is SQLi in this page or not.</p>
<p><code>http://pentesterlab/sqli/example9.php?order=IF(1,name,age)</code></p>
<p>Thanks all, I&rsquo;ve really enjoyed going through these challenges. I hope you get something from them!</p>
        </div>

        
        
        <div class="article-toc" >
            <h3>Contents</h3>
            <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#sql-injection">SQL Injection</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
        
        

        


        
        <footer class="article-footer">
            <ul class="article-tag-list">
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/web">web
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/sqli">sqli
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/beginner">beginner
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://multiplex3r.github.io//tags/offence">offence
                    </a>
                </li>
                
            </ul>
        </footer>
        
    </div>
    
<nav id="article-nav">
    
    <a href="/posts/2015-10-13-web-for-pentester-directory-traversal/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            Web for Pentester ../../Directory%20Traversal
        </div>
    </a>
    
    
    <a href="/posts/2015-02-15-web-for-pentester-xss/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">Web for Pentester XSS!&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>


</article>

        
    </section>
    <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2020 multiplex3r.github.io
            <br />
            Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/carsonip/hugo-theme-minos" target="_blank">Minos</a>
        </div>
    </div>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function () {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>

</div>
</body>
</html>
